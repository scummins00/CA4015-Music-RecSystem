
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction &#8212; CA4015 Music Recommender System</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Preliminary Data Analysis" href="Preliminary_Data_Analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">CA4015 Music Recommender System</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 current">
  <a class="reference internal" href="#">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Preliminary_Data_Analysis.html">
   Preliminary Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Matrix_Factorization.html">
   Collaborative Filtering - Matrix Factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Deep_Learning_Recommender_System.html">
   Deep Neural Network Recommender System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Advanced_Deep_Learning_Recommender_System.html">
   Advanced Deep Learning Recommender System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conclusions.html">
   Conclusions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/intro.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Introduction
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#collaborative-filtering">
   Collaborative Filtering
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-factorisation-mf">
     Matrix Factorisation (MF)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deep-neural-networks">
     Deep Neural Networks
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Computer-based systems provide us with the opportunity of mining user history to reveal trends and personal preferences that they, and those around them, may not have previously realised <span id="id1">[<a class="reference internal" href="bibliography.html#id2">Ekstrand <em>et al.</em>, 2011</a>]</span>. A vast amount of research has been conducted on how to best recommend content to users and many methods have been proposed <span id="id2">[<a class="reference internal" href="bibliography.html#id4">Balabanović and Shoham, 1997</a>, <a class="reference internal" href="bibliography.html#id6">Guttman <em>et al.</em>, 1998</a>, <a class="reference internal" href="bibliography.html#id5">Pazzani, 1999</a>]</span>.</p>
<p>In this research, we will be focusing on Collaborative Filtering <span id="id3">[<a class="reference internal" href="bibliography.html#id8">Su and Khoshgoftaar, 2009</a>, <a class="reference internal" href="bibliography.html#id7">Thorat <em>et al.</em>, 2015</a>]</span>, an approach that decides what to recommend to a user based on the preferences of similar users <span id="id4">[<a class="reference internal" href="bibliography.html#id9">Elahi <em>et al.</em>, 2016</a>, <a class="reference internal" href="bibliography.html#id8">Su and Khoshgoftaar, 2009</a>]</span>. Similarity between users is estimated by comparing user-interactions and ratings with products or services <span id="id5">[<a class="reference internal" href="bibliography.html#id9">Elahi <em>et al.</em>, 2016</a>, <a class="reference internal" href="bibliography.html#id7">Thorat <em>et al.</em>, 2015</a>]</span>. The table below highlights some popular services currently using recommender systems.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Service</p></th>
<th class="text-align:center head"><p>Recommendations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Amazon</p></td>
<td class="text-align:center"><p>Retail Products</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Facebook (Meta)</p></td>
<td class="text-align:center"><p>Friends</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Netflix</p></td>
<td class="text-align:center"><p>Movies / Shows</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Spotify</p></td>
<td class="text-align:center"><p>Music</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Youtube</p></td>
<td class="text-align:center"><p>Videos</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Google News</p></td>
<td class="text-align:center"><p>News</p></td>
</tr>
</tbody>
</table>
<p>Recommending something to someone else is a natural process that aims to help somebody sift through a large corpus of information efficiently to find only the items of most interest to them. Recommender systems augment that process, and as such have become a vital tool for information-availability in our increasingly digital lives <span id="id6">[<a class="reference internal" href="bibliography.html#id8">Su and Khoshgoftaar, 2009</a>]</span>.</p>
<p>In the following Jupyter Book, we will be using data acquired from the <a class="reference external" href="https://grouplens.org/datasets/hetrec-2011/">HETREC 2011</a><span id="id7">[<a class="reference internal" href="bibliography.html#id3">Cantador <em>et al.</em>, 2011</a>]</span> 2nd International Workshop on Information Heterogeneity and Fusion in Recommender Systems. In particular, we will be focusing on the <em>artist listening records</em> dataset published by <a class="reference external" href="https://www.last.fm/">Last.FM</a>. This dataset consists of 92,800 artists listening records from 1,892 users. We will explore this data in more detail in <a class="reference internal" href="Preliminary_Data_Analysis.html"><span class="doc">Preliminary Data Analysis</span></a>. In the following section, we will discuss in-depth two approaches to Collaborative Filtering, namely; <em>Matrix Factorisation</em>, and <em>Recommendation with Deep Neural Networks</em>.</p>
</div>
<div class="section" id="collaborative-filtering">
<h1>Collaborative Filtering<a class="headerlink" href="#collaborative-filtering" title="Permalink to this headline">¶</a></h1>
<p>Collaborative Filtering (CF) was a term first coined by the makers of <em>Tapestry</em>, the first recommender system.
CF aims to solve the problem of recommending <span class="math notranslate nohighlight">\(m\)</span> items, by <span class="math notranslate nohighlight">\(n\)</span> users where the data is often represented by a <span class="math notranslate nohighlight">\(n \times m\)</span> matrix <span id="id8">[<a class="reference internal" href="bibliography.html#id10">Laishram <em>et al.</em>, 2016</a>]</span>. There are two main approaches to CF, <em>neighborhood methods</em>, and <em>latent factor models</em>. The neighborhood methods compute the relationships between users, or alternatively items. Latent Factor models aim to characetrize users and items on many abstract factors infered from the rating patterns. The most successful realisations of latent factor models are based on <em>matrix facotrisation</em> (MF). <span id="id9">[<a class="reference internal" href="bibliography.html#id11">Koren <em>et al.</em>, 2009</a>]</span>. In this section, we will look at MF more closely, focusing on the aspects we will incorporate during our research.</p>
<div class="section" id="matrix-factorisation-mf">
<h2>Matrix Factorisation (MF)<a class="headerlink" href="#matrix-factorisation-mf" title="Permalink to this headline">¶</a></h2>
<p>In its basic form, MF characterises querys (users) and items by vectors which are inferred from rating patterns. High correspondance between query vector and item vector results in a recommendation. The most useful data from an MF model is <em>explicit</em> feedback. This constitutes explicit input from users regarding interest in items. We refer to this as <em>rating</em> <span id="id10">[<a class="reference internal" href="bibliography.html#id11">Koren <em>et al.</em>, 2009</a>]</span>. The construction of query and item vectors intends to model user preferences as shown in the figure below.</p>
<a class="bg-primary mb-1 reference internal image-reference" href="_images/mf_latent_factors.png"><img alt="latent_factor_diagram" class="bg-primary mb-1 align-center" src="_images/mf_latent_factors.png" style="width: 40%;" /></a>
<p>As stated previously, in MF, we are given the feedback matrix denoted <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the number of queries and <span class="math notranslate nohighlight">\(n\)</span> is the number of items. We will denote our user vector <span class="math notranslate nohighlight">\(U \in \mathbb{R}^{m \times d}\)</span>, and our item vector <span class="math notranslate nohighlight">\(V \in \mathbb{R}^{n \times d}\)</span>. We will use the product <span class="math notranslate nohighlight">\(UV^{T}\)</span> as our approximation of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Our objective function is then defined as follows:
$<span class="math notranslate nohighlight">\(
    \min _{U \in \mathbb{R}^{m \times d}, V \in \mathbb{R}^{n \times d}}\sum_{(i,j) \in obs} (A_{ij} - \langle U_{i},V_{j} \rangle)^{2}
\)</span>$</p>
<p>The two standard approaches to minimizing error in CF are <em>Alternating Least Squares</em> (ALS) <span id="id11">[<a class="reference internal" href="bibliography.html#id12">Cichocki and Zdunek, 2007</a>]</span>, and <em>Stochaistic Gradient Descent</em> (SGD) <span id="id12">[<a class="reference internal" href="bibliography.html#id13">Gemulla <em>et al.</em>, 2011</a>]</span>. <em>Weighted Alternating Least Squares</em> (WALS) is a modified version of ALS that is suited to MF. In the literature, it is often cited that WALS is the prefered algorithm for recommender systems. This is because WALS is optimised for parallelization, meaning it is scalable to large scale data. As well as this, ALS performs better than SGD on systems centered on implicit data <span id="id13">[<a class="reference internal" href="bibliography.html#id11">Koren <em>et al.</em>, 2009</a>]</span>. SGD cannot directly scale to very large data <span id="id14">[<a class="reference internal" href="bibliography.html#id13">Gemulla <em>et al.</em>, 2011</a>]</span>. Taking our own problem into consideration, either approach is suitable. The recognised benefits of WALS are not of interest to us as parallelization is out of the scope for this research. We have no information regarding intrinsic user data such as age, country, etc. Our dataset is also small enough that the performance of SGD is not severly hindered. Therefore, we will adopt SGD in this approach.</p>
</div>
<div class="section" id="deep-neural-networks">
<h2>Deep Neural Networks<a class="headerlink" href="#deep-neural-networks" title="Permalink to this headline">¶</a></h2>
<p>Advances in deep learning-based recommender systems have gained notable traction over the past years. This goes hand-in-hand with the increased adoption of deep learning frameworks in most ML applications. Deep learning can effectively capture nonlinear and nontrivial user-item relationships through complex data abstraction <span id="id15">[<a class="reference internal" href="bibliography.html#id18">Zhang <em>et al.</em>, 2019</a>]</span>.</p>
<p>To develop our own deep neural network recommender, we will employ Tensorflow V2, with an emphasis on the <a class="reference external" href="https://www.tensorflow.org/recommenders/api_docs/python/tfrs"><em>Tensorflow Recommedation Systems</em></a> (TFRS) package. Tensorflow is developed by Google, the leading experts in recommendation systems. The TFRS package can be used through Keras which is an API built atop Tensorflow. TFRS provides a large volume functions designed spcifically for working with recommender systems.</p>
<p>Google have also authored many publications regarding their philosophy regarding recommender systems for their various applications <span id="id16">[<a class="reference internal" href="bibliography.html#id17">Cheng <em>et al.</em>, 2016</a>, <a class="reference internal" href="bibliography.html#id16">Covington <em>et al.</em>, 2016</a>]</span>. They regularly follow a repeating pattern of developing two seperate ‘Towers’, a user (query) tower, and an item (candidate) tower. Each of these towers can have varying levels of complexity, and can host deep learning embedings. A combined model of the outputs of these seperate towers is then designed as a feed-forward deep network.</p>
<p>Google also regularly advice a two-tier approach to recommender systems. That is: a retrieval model, and a ranking model. Their typical architeture is displayed in the image below, which has been abstracted from <span id="id17">[<a class="reference internal" href="bibliography.html#id17">Cheng <em>et al.</em>, 2016</a>]</span></p>
<a class="bg-primary mb-1 reference internal image-reference" href="_images/google_architecture.png"><img alt="google_achitecture" class="bg-primary mb-1 align-center" src="_images/google_architecture.png" style="width: 40%;" /></a>
<p>The TFRS package allows for the easy creation of recommender models by following simple steps. Firstly, one must inheret from the base <code class="docutils literal notranslate"><span class="pre">tfrs.Model</span></code> class, which is packaged with many utility functions. We build our objective function (<em>denoted as the task</em>) on top of this class. Using different objective functions is simply a case of swapping out a single line of code. In our examples, we will make use of the <em>Adaptive Gradient Algorithm</em> (Adagrad), which is an SGD optimiser. It works by maintaining low learning rates (usually denoted <span class="math notranslate nohighlight">\(\alpha \)</span>) for frequently occuring features, and high learning rates for less frequent features. Where we can, we will use <em>Root Mean Squared Error</em> (RMSE) as our metric for model comparison.</p>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
     <div id="next">
        <a class="right-next" href="Preliminary_Data_Analysis.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Preliminary Data Analysis</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sean Cummins<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>